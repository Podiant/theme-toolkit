<!--
The homepage template, shown when the user is looking at the first 10 episodes
(andn any pinned blog posts) of the podcast
-->

{{# with page_obj.first_object }}
    <div class="post-list-item">
        <!-- Add a separator in-between items -->
        {{# if @index }}<hr>{{/ if }}

        <!-- Show this section on tablet and desktop -->
        <div class="row hidden-xs">
            <div class="col-sm-2">
                <span class="datetime">
                    <!-- If the episode has a published date, show it -->
                    <small class="text-muted">Posted<br></small>
                    {{ date published 'MMM Do YY' }}
                </span>

                <!-- If in network mode, show the podcast artwork -->
                {{# unless ../is_podcast }}
                    <a href="{{ podcast_url }}" title="{{ podcast_name }}">
                        <img src="{{ podcast_image }}" width="30" class="pull-right" />
                    </a>
                {{/ unless }}
            </div>

            <div class="col-sm-10">
                <div class="article">
                    <h2><a href="{{ share_url }}">{{ title }}</a></h2>
                    <!-- Show the player -->

                    {{{ iframe }}}

                    <!-- Show a summary of the episode -->
                    {{{ summary }}}
                </div>
            </div>
        </div>
        <!-- End tablet and desktop section -->

        <!-- Show this section on smartphones -->
        <div class="media visible-xs">
            <a class="pull-left" href="{{ share_url }}">
                <img class="media-object" src="{{ image }}" width="100" />
            </a>
            <div class="media-body">
                <h3 class="media-heading">
                    <a href="{{ share_url }}">{{ title }}</a>
                </h3>

                <p>{{ summary }}</p>
            </div>
        </div>
        <!-- End smartphone section -->
    </div>
{{/ with }}

<!-- Loop through any pinned blog posts. There should either be 0 or 1 -->
{{# each pinned_blog_posts }}
    <div class="post-list-item">
        <hr>

        <!-- Show this section on tablet and desktop -->
        <div class="row hidden-xs">
            <div class="col-sm-10">
                <!-- Not all blog posts need a title. Only show this section if a title is set -->
                {{# exists post_image }}
                    <a href="{{ post_url }}" title="{{ title }}" class="squashed unit">
                        <img class="bg" src="{{ post_image }}" />

                        {{# exists post_title }}
                            <div class="article">
                                <div class="text">
                                    <!-- Not all blog posts need a title. Only show this section if a title is set -->
                                    {{# exists post_title }}
                                        <h2>{{ post_title }}</h2>
                                    {{/ exists }}

                                    <!-- Show an excerpt of the post, if there is any text -->
                                    {{# exists post_summary }}{{{ post_summary }}}{{/ exists }}
                                </div>
                            </div>
                        {{/ exists }}
                    </a>
                {{ else }}
                    <div class="article">
                        <!-- Not all blog posts need a title. Only show this section if a title is set -->
                        {{# exists post_title }}
                            <!-- Link to the post and show the title -->
                            <h2><a href="{{ post_url }}">{{ post_title }}</a></h2>
                        {{/ exists }}

                        <!-- Some blog posts have embeddable content, like polls or videos. Show that here -->
                        {{# exists post_embed }}{{{ post_embed }}}{{/ exists }}

                        <!-- Show an excerpt of the post, if there is any text -->
                        {{# exists post_summary }}{{{ post_summary }}}{{/ exists }}
                    </div>
                {{/ exists }}
            </div>
        </div>
        <!-- End tablet and desktop section -->

        <!-- Show this section on smartphones -->
        <div class="media visible-xs">
            {{# exists post_image }}
                <a class="pull-left" href="{{ post_url }}">
                    <img class="media-object" src="{{ post_image }}" width="100" class="pull-right" />
                </a>
            {{/ exists }}

            <div class="media-body">
                {{# exists post_title }}
                    <!-- Link to the post and show the title -->
                    <h3 class="media-heading">
                        <a href="{{ share_url }}">{{ post_title }}</a>
                    </h3>
                {{/ exists }}

                <!-- Show an excerpt of the post, if there is any text -->
                {{# exists post_summary }}{{{ post_summary }}}{{/ exists }}
            </div>
        </div>
        <!-- End smartphone section -->
    </div>
{{/ each }}

<!--
All of that was just to show the first episode and any pinned blog posts,
along with info about the podcast. Now we're going to list the remaining
episodes in the podcast
-->
{{# each page_obj.subsequent_objects }}
    <!-- Loop through each subsequent episode in the list (all but the first) -->
    <div class="post-list-item">
        <hr>

        <!-- Show this section on tablet and desktop -->
        <div class="row hidden-xs">
            <div class="col-sm-2">
                <span class="datetime">
                    <small class="text-muted">Posted<br></small>
                    {{ date published 'MMM Do YY' }}
                </span>

                <!-- If in network mode, show the podcast artwork -->
                {{# unless is_podcast }}
                    <a href="{{ podcast_url }}" title="{{ podcast_name }}">
                        <img src="{{ podcast_image }}" width="30" class="pull-right" />
                    </a>
                {{/ unless }}
            </div>

            <div class="col-sm-10">
                <div class="article">
                    <h2><a href="{{ share_url }}">{{ title }}</a></h2>
                    <!-- Show the player -->
                    {{{ iframe }}}

                    <!-- Show a summary of the episode -->
                    {{{ summary }}}
                </div>
            </div>
        </div>
        <!-- End tablet and desktop section -->

        <!-- Show this section on smartphones -->
        <div class="media visible-xs">
            <a class="pull-left" href="{{ share_url }}">
                <img class="media-object" src="{{ image }}" width="100" />
            </a>
            <div class="media-body">
                <h3 class="media-heading">
                    <a href="{{ share_url }}">{{ title }}</a>
                </h3>

                <p>{{ summary }}</p>
            </div>
        </div>
        <!-- End smartphone section -->
    </div>
{{/ each }}

<!--
If there are any more episodes to view, add previous/next page links and a range
of buttons linking to individual pages
-->
{{# if page_obj.has_next_or_previous }}
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <li{{# unless page_obj.has_previous }} class="disabled"{{/ unless }}>
                <a{{# if page_obj.has_previous }} href="?page={{ page_obj.previous_page_number }}"{{/ if }} aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            {{# each paginator.page_range }}
                <li{{# if selected }} class="active"{{/ if }}>
                    <a href="?page={{ number }}">{{ number }}</a>
                </li>
            {{/ each }}
            <li{{# unless page_obj.has_next }} class="disabled"{{/ unless }}>
                <a{{# if page_obj.has_next }} href="?page={{ page_obj.next_page_number }}"{{/ if }} aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
{{/ if }}
